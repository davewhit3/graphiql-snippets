{
  "version": 3,
  "sources": ["../../.pnpm/codemirror-graphql@2.2.1_@codemirror+language@6.0.0_codemirror@5.65.19_graphql@16.11.0/node_modules/codemirror-graphql/src/utils/info-addon.ts"],
  "sourcesContent": ["/**\n *  Copyright (c) 2021 GraphQL Contributors\n *  All rights reserved.\n *\n *  This source code is licensed under the BSD-style license found in the\n *  LICENSE file in the root directory of this source tree. An additional grant\n *  of patent rights can be found in the PATENTS file in the same directory.\n */\n\nimport CodeMirror from 'codemirror';\nimport { GraphQLInfoOptions } from '../info';\n\nCodeMirror.defineOption(\n  'info',\n  false,\n  (\n    cm: CodeMirror.Editor,\n    options: GraphQLInfoOptions,\n    old?: GraphQLInfoOptions,\n  ) => {\n    if (old && old !== CodeMirror.Init) {\n      const oldOnMouseOver = cm.state.info.onMouseOver;\n      CodeMirror.off(cm.getWrapperElement(), 'mouseover', oldOnMouseOver);\n      clearTimeout(cm.state.info.hoverTimeout);\n      delete cm.state.info;\n    }\n\n    if (options) {\n      const state: Record<string, any> = (cm.state.info = createState(options));\n      state.onMouseOver = onMouseOver.bind(null, cm);\n      CodeMirror.on(cm.getWrapperElement(), 'mouseover', state.onMouseOver);\n    }\n  },\n);\n\nfunction createState(options: GraphQLInfoOptions) {\n  return {\n    options:\n      options instanceof Function\n        ? { render: options }\n        : options === true\n          ? {}\n          : options,\n  };\n}\n\nfunction getHoverTime(cm: CodeMirror.Editor) {\n  const { options } = cm.state.info;\n  return options?.hoverTime || 500;\n}\n\nfunction onMouseOver(cm: CodeMirror.Editor, e: MouseEvent) {\n  const state = cm.state.info;\n\n  const target = e.target || e.srcElement;\n\n  if (!(target instanceof HTMLElement)) {\n    return;\n  }\n  if (target.nodeName !== 'SPAN' || state.hoverTimeout !== undefined) {\n    return;\n  }\n\n  const box = target.getBoundingClientRect();\n\n  const onMouseMove = function () {\n    clearTimeout(state.hoverTimeout);\n    state.hoverTimeout = setTimeout(onHover, hoverTime);\n  };\n\n  const onMouseOut = function () {\n    CodeMirror.off(document, 'mousemove', onMouseMove);\n    CodeMirror.off(cm.getWrapperElement(), 'mouseout', onMouseOut);\n    clearTimeout(state.hoverTimeout);\n    state.hoverTimeout = undefined;\n  };\n\n  const onHover = function () {\n    CodeMirror.off(document, 'mousemove', onMouseMove);\n    CodeMirror.off(cm.getWrapperElement(), 'mouseout', onMouseOut);\n    state.hoverTimeout = undefined;\n    onMouseHover(cm, box);\n  };\n\n  const hoverTime = getHoverTime(cm);\n  state.hoverTimeout = setTimeout(onHover, hoverTime);\n\n  CodeMirror.on(document, 'mousemove', onMouseMove);\n  CodeMirror.on(cm.getWrapperElement(), 'mouseout', onMouseOut);\n}\n\nfunction onMouseHover(cm: CodeMirror.Editor, box: DOMRect) {\n  const pos = cm.coordsChar(\n    {\n      left: (box.left + box.right) / 2,\n      top: (box.top + box.bottom) / 2,\n    },\n    'window',\n  ); // 'window' allows to work when editor is not full page and window has scrolled\n\n  const state = cm.state.info;\n  const { options } = state;\n  const render = options.render || cm.getHelper(pos, 'info');\n  if (render) {\n    const token = cm.getTokenAt(pos, true);\n    if (token) {\n      const info: HTMLDivElement = render(token, options, cm, pos);\n      if (info) {\n        showPopup(cm, box, info);\n      }\n    }\n  }\n}\n\nfunction showPopup(cm: CodeMirror.Editor, box: DOMRect, info: HTMLDivElement) {\n  const popup = document.createElement('div');\n  popup.className = 'CodeMirror-info';\n  popup.append(info);\n  document.body.append(popup);\n\n  const popupBox = popup.getBoundingClientRect();\n  const popupStyle = window.getComputedStyle(popup);\n  const popupWidth =\n    popupBox.right -\n    popupBox.left +\n    parseFloat(popupStyle.marginLeft) +\n    parseFloat(popupStyle.marginRight);\n  const popupHeight =\n    popupBox.bottom -\n    popupBox.top +\n    parseFloat(popupStyle.marginTop) +\n    parseFloat(popupStyle.marginBottom);\n\n  let topPos = box.bottom;\n  if (\n    popupHeight > window.innerHeight - box.bottom - 15 &&\n    box.top > window.innerHeight - box.bottom\n  ) {\n    topPos = box.top - popupHeight;\n  }\n\n  if (topPos < 0) {\n    topPos = box.bottom;\n  }\n\n  let leftPos = Math.max(0, window.innerWidth - popupWidth - 15);\n  if (leftPos > box.left) {\n    leftPos = box.left;\n  }\n\n  popup.style.opacity = '1';\n  popup.style.top = topPos + 'px';\n  popup.style.left = leftPos + 'px';\n\n  let popupTimeout: NodeJS.Timeout;\n\n  const onMouseOverPopup = function () {\n    clearTimeout(popupTimeout);\n  };\n\n  const onMouseOut = function () {\n    clearTimeout(popupTimeout);\n    popupTimeout = setTimeout(hidePopup, 200);\n  };\n\n  const hidePopup = function () {\n    CodeMirror.off(popup, 'mouseover', onMouseOverPopup);\n    CodeMirror.off(popup, 'mouseout', onMouseOut);\n    CodeMirror.off(cm.getWrapperElement(), 'mouseout', onMouseOut);\n\n    if (popup.style.opacity) {\n      popup.style.opacity = '0';\n      setTimeout(() => {\n        if (popup.parentNode) {\n          popup.remove();\n        }\n      }, 600);\n    } else if (popup.parentNode) {\n      popup.remove();\n    }\n  };\n\n  CodeMirror.on(popup, 'mouseover', onMouseOverPopup);\n  CodeMirror.on(popup, 'mouseout', onMouseOut);\n  CodeMirror.on(cm.getWrapperElement(), 'mouseout', onMouseOut);\n}\n"],
  "mappings": ";;;;;;;;AASA,wBAAuB;AAGvB,kBAAAA,QAAW,aACT,QACA,OACA,CACE,IACA,SACA,QACE;AACF,MAAI,OAAO,QAAQ,kBAAAA,QAAW,MAAM;AAClC,UAAM,iBAAiB,GAAG,MAAM,KAAK;AACrC,sBAAAA,QAAW,IAAI,GAAG,kBAAiB,GAAI,aAAa,cAAc;AAClE,iBAAa,GAAG,MAAM,KAAK,YAAY;AACvC,WAAO,GAAG,MAAM;;AAGlB,MAAI,SAAS;AACX,UAAM,QAA8B,GAAG,MAAM,OAAO,YAAY,OAAO;AACvE,UAAM,cAAc,YAAY,KAAK,MAAM,EAAE;AAC7C,sBAAAA,QAAW,GAAG,GAAG,kBAAiB,GAAI,aAAa,MAAM,WAAW;;AAExE,CAAC;AAGH,SAAS,YAAY,SAA2B;AAC9C,SAAO;IACL,SACE,mBAAmB,WACf,EAAE,QAAQ,QAAO,IACjB,YAAY,OACV,CAAA,IACA;;AAEZ;AAEA,SAAS,aAAa,IAAqB;AACzC,QAAM,EAAE,QAAO,IAAK,GAAG,MAAM;AAC7B,UAAO,YAAO,QAAP,YAAO,SAAA,SAAP,QAAS,cAAa;AAC/B;AAEA,SAAS,YAAY,IAAuB,GAAa;AACvD,QAAM,QAAQ,GAAG,MAAM;AAEvB,QAAM,SAAS,EAAE,UAAU,EAAE;AAE7B,MAAI,EAAE,kBAAkB,cAAc;AACpC;;AAEF,MAAI,OAAO,aAAa,UAAU,MAAM,iBAAiB,QAAW;AAClE;;AAGF,QAAM,MAAM,OAAO,sBAAqB;AAExC,QAAM,cAAc,WAAA;AAClB,iBAAa,MAAM,YAAY;AAC/B,UAAM,eAAe,WAAW,SAAS,SAAS;EACpD;AAEA,QAAM,aAAa,WAAA;AACjB,sBAAAA,QAAW,IAAI,UAAU,aAAa,WAAW;AACjD,sBAAAA,QAAW,IAAI,GAAG,kBAAiB,GAAI,YAAY,UAAU;AAC7D,iBAAa,MAAM,YAAY;AAC/B,UAAM,eAAe;EACvB;AAEA,QAAM,UAAU,WAAA;AACd,sBAAAA,QAAW,IAAI,UAAU,aAAa,WAAW;AACjD,sBAAAA,QAAW,IAAI,GAAG,kBAAiB,GAAI,YAAY,UAAU;AAC7D,UAAM,eAAe;AACrB,iBAAa,IAAI,GAAG;EACtB;AAEA,QAAM,YAAY,aAAa,EAAE;AACjC,QAAM,eAAe,WAAW,SAAS,SAAS;AAElD,oBAAAA,QAAW,GAAG,UAAU,aAAa,WAAW;AAChD,oBAAAA,QAAW,GAAG,GAAG,kBAAiB,GAAI,YAAY,UAAU;AAC9D;AAEA,SAAS,aAAa,IAAuB,KAAY;AACvD,QAAM,MAAM,GAAG,WACb;IACE,OAAO,IAAI,OAAO,IAAI,SAAS;IAC/B,MAAM,IAAI,MAAM,IAAI,UAAU;KAEhC,QAAQ;AAGV,QAAM,QAAQ,GAAG,MAAM;AACvB,QAAM,EAAE,QAAO,IAAK;AACpB,QAAM,SAAS,QAAQ,UAAU,GAAG,UAAU,KAAK,MAAM;AACzD,MAAI,QAAQ;AACV,UAAM,QAAQ,GAAG,WAAW,KAAK,IAAI;AACrC,QAAI,OAAO;AACT,YAAM,OAAuB,OAAO,OAAO,SAAS,IAAI,GAAG;AAC3D,UAAI,MAAM;AACR,kBAAU,IAAI,KAAK,IAAI;;;;AAI/B;AAEA,SAAS,UAAU,IAAuB,KAAc,MAAoB;AAC1E,QAAM,QAAQ,SAAS,cAAc,KAAK;AAC1C,QAAM,YAAY;AAClB,QAAM,OAAO,IAAI;AACjB,WAAS,KAAK,OAAO,KAAK;AAE1B,QAAM,WAAW,MAAM,sBAAqB;AAC5C,QAAM,aAAa,OAAO,iBAAiB,KAAK;AAChD,QAAM,aACJ,SAAS,QACT,SAAS,OACT,WAAW,WAAW,UAAU,IAChC,WAAW,WAAW,WAAW;AACnC,QAAM,cACJ,SAAS,SACT,SAAS,MACT,WAAW,WAAW,SAAS,IAC/B,WAAW,WAAW,YAAY;AAEpC,MAAI,SAAS,IAAI;AACjB,MACE,cAAc,OAAO,cAAc,IAAI,SAAS,MAChD,IAAI,MAAM,OAAO,cAAc,IAAI,QACnC;AACA,aAAS,IAAI,MAAM;;AAGrB,MAAI,SAAS,GAAG;AACd,aAAS,IAAI;;AAGf,MAAI,UAAU,KAAK,IAAI,GAAG,OAAO,aAAa,aAAa,EAAE;AAC7D,MAAI,UAAU,IAAI,MAAM;AACtB,cAAU,IAAI;;AAGhB,QAAM,MAAM,UAAU;AACtB,QAAM,MAAM,MAAM,SAAS;AAC3B,QAAM,MAAM,OAAO,UAAU;AAE7B,MAAI;AAEJ,QAAM,mBAAmB,WAAA;AACvB,iBAAa,YAAY;EAC3B;AAEA,QAAM,aAAa,WAAA;AACjB,iBAAa,YAAY;AACzB,mBAAe,WAAW,WAAW,GAAG;EAC1C;AAEA,QAAM,YAAY,WAAA;AAChB,sBAAAA,QAAW,IAAI,OAAO,aAAa,gBAAgB;AACnD,sBAAAA,QAAW,IAAI,OAAO,YAAY,UAAU;AAC5C,sBAAAA,QAAW,IAAI,GAAG,kBAAiB,GAAI,YAAY,UAAU;AAE7D,QAAI,MAAM,MAAM,SAAS;AACvB,YAAM,MAAM,UAAU;AACtB,iBAAW,MAAK;AACd,YAAI,MAAM,YAAY;AACpB,gBAAM,OAAM;;MAEhB,GAAG,GAAG;eACG,MAAM,YAAY;AAC3B,YAAM,OAAM;;EAEhB;AAEA,oBAAAA,QAAW,GAAG,OAAO,aAAa,gBAAgB;AAClD,oBAAAA,QAAW,GAAG,OAAO,YAAY,UAAU;AAC3C,oBAAAA,QAAW,GAAG,GAAG,kBAAiB,GAAI,YAAY,UAAU;AAC9D;",
  "names": ["CodeMirror"]
}
